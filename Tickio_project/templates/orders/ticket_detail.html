{% extends 'base.html' %}

{% block title %}Detalle de tu Ticket - Tickio{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <div class="card shadow-lg">
                <div class="card-header bg-primary text-white">
                    <h2 class="card-title mb-0">Ticket para: {{ ticket.event.nombre }}</h2>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-7">
                            <h4 class="card-subtitle mb-3 text-muted">{{ ticket.ticket_type.name }}</h4>
                            <p><strong>Titular:</strong> {{ ticket.user.get_full_name|default:ticket.user.username }}</p>
                            <p><strong>Fecha del evento:</strong> {{ ticket.event.fecha|date:"d/m/Y H:i" }}</p>
                            <p><strong>Ubicación:</strong> {{ ticket.event.ubicacion }}</p>
                            <p><strong>Orden de Compra:</strong> #{{ ticket.order.id }}</p>
                            <p><strong>Código de Ticket:</strong></p>
                            <pre class="bg-light p-2 rounded"><code>{{ ticket.unique_code }}</code></pre>
                            <p class="mt-3">
                                <span class="badge {% if ticket.is_used %}badge-danger{% else %}badge-success{% endif %}">
                                    {% if ticket.is_used %}TICKET USADO{% else %}TICKET VÁLIDO{% endif %}
                                </span>
                            </p>
                        </div>
                        <div class="col-md-5 text-center">
                            <p class="mb-2">Escanea este código para validar</p>
                            <img src="data:image/png;base64,{{ qr_code }}" alt="Código QR del Ticket" class="img-fluid rounded">
                        </div>
                    </div>
                </div>
                <div class="card-footer text-muted text-center">
                    Presenta este ticket (impreso o en tu móvil) en la entrada del evento.
                </div>
            </div>
            <div class="text-center mt-4">
                <a href="{% url 'my_orders' %}" class="btn btn-secondary">Volver a Mis Órdenes</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}